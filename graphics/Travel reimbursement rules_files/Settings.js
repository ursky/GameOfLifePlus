var XWiki=(function(a){a.AnnotationSettings=Class.create({initialize:function(){this.addCheckboxListeners();this.addClearListeners();this.addToggleFilterVisibility(".criterion-label",".criterion","collapsed");this.addToggleFilterVisibility(".annotation-filters-toggler a",".annotation-filters","collapsed");document.fire("xwiki:annotations:filter:changed",this.getCurrentFilter())},addCheckboxListeners:function(){$$(".criteria input[type=checkbox]").each(function(b){b.observe("click",function(f){var d=this.getCurrentFilter();document.fire("xwiki:annotations:filter:changed",d);var c=f.element();c.up().toggleClassName("selected");var e=c.up(".criterion");if(e.select("label.selected").size()>0){e.addClassName("active")}else{e.removeClassName("active")}}.bindAsEventListener(this))},this)},addClearListeners:function(){$$(".criterion .clear").each(function(b){b.observe("click",function(e){e.stop();var d=e.element().up(".criterion");d.select("label.selected").each(function(f){f.removeClassName("selected");f.down("input").checked=false});d.removeClassName("active");var c=this.getCurrentFilter();document.fire("xwiki:annotations:filter:changed",c)}.bindAsEventListener(this))},this)},getCurrentFilter:function(){var b=[];$$(".criteria .criterion").each(function(f){var e=f.down("input[type=hidden]");if(!e){return}e=e.name;var c=[];f.select("input[type=checkbox]").each(function(g){if(g.checked){c.push(g.value)}});for(var d=0;d<c.length;d++){b.push({name:e,value:c[d]})}});return b},addToggleFilterVisibility:function(c,d,b){$$(c).each(function(e){e.observe("click",function(g){g.stop();var f=g.element().up(d);if(f){f.toggleClassName(b)}})})}});return a}(XWiki||{}));document.observe("xwiki:annotations:settings:loaded",function(){new XWiki.AnnotationSettings()});